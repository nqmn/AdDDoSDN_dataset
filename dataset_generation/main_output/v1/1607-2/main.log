2025-07-16 13:24:55 - [MAIN] - INFO - Cleaning up any previous Mininet instances...
2025-07-16 13:24:57 - [MAIN] - INFO - Mininet cleanup complete.
2025-07-16 13:24:57,129 - __main__ - INFO - Verifying required tools...
2025-07-16 13:24:57,354 - __main__ - INFO - TShark version: Running as user "root" and group "root". This could be dangerous.
2025-07-16 13:24:57,355 - __main__ - INFO - All required tools are available.
2025-07-16 13:24:57 - [MAIN] - INFO - Using configuration file: /home/user/Desktop/dataset_generation/config.json
2025-07-16 13:24:57,355 - __main__ - INFO - Starting Ryu SDN controller...
2025-07-16 13:24:57,361 - __main__ - INFO - Ryu controller started with PID: 87560. See main_output/ryu.log for logs.
2025-07-16 13:24:57,362 - __main__ - INFO - Checking for controller on port 6653 (timeout: 30s)...
2025-07-16 13:24:58,388 - __main__ - INFO - Controller is up and listening.
2025-07-16 13:24:58 - [MAIN] - INFO - Testing /hello endpoint...
2025-07-16 13:24:58 - [MAIN] - INFO - Test /hello endpoint: PASSED
2025-07-16 13:24:58,396 - __main__ - INFO - Setting up Mininet topology...
2025-07-16 13:24:58,645 - __main__ - INFO - Mininet version: 
2025-07-16 13:24:58,654 - __main__ - INFO - Connecting to remote controller at 127.0.0.1:6653
2025-07-16 13:25:00,929 - __main__ - INFO - Mininet network started successfully.
2025-07-16 13:25:00,929 - __main__ - INFO - Running Mininet pingall test...
2025-07-16 13:25:06,022 - __main__ - INFO - Mininet pingall test completed successfully. Packet loss: 0.0%
2025-07-16 13:25:06,022 - __main__ - INFO - Starting traffic generation scenario...
2025-07-16 13:25:06,022 - __main__ - INFO - Phase 1: Initialization (5s)...
2025-07-16 13:25:11,032 - __main__ - INFO - Starting flow statistics collection for 23825 seconds...
2025-07-16 13:25:11,032 - __main__ - INFO - Flow statistics collection started in background.
2025-07-16 13:25:11,034 - __main__ - INFO - Phase 2: Normal Traffic (3600s)...
2025-07-16 13:25:11,034 - __main__ - INFO - Timeline updated: normal phase started at 1752643511.0347137
2025-07-16 14:25:15,158 - __main__ - INFO - Stopping packet capture (PID: 87829)...
2025-07-16 14:25:15,237 - __main__ - INFO - Packet capture stopped.
2025-07-16 14:25:15,237 - __main__ - INFO - Phase 3.1: Enhanced Traditional DDoS Attacks...
2025-07-16 14:25:15,238 - __main__ - INFO - Timeline updated: syn_flood phase started at 1752647115.2380128
2025-07-16 14:30:19,839 - __main__ - INFO - Stopping packet capture (PID: 111346)...
2025-07-16 14:30:19,898 - __main__ - INFO - Packet capture stopped.
2025-07-16 14:30:19,899 - __main__ - INFO - Timeline updated: udp_flood phase started at 1752647419.8991165
2025-07-16 14:35:27,444 - __main__ - INFO - Stopping packet capture (PID: 111359)...
2025-07-16 14:35:27,499 - __main__ - INFO - Packet capture stopped.
2025-07-16 14:35:27,499 - __main__ - INFO - Timeline updated: icmp_flood phase started at 1752647727.4994943
2025-07-16 14:40:32,082 - __main__ - INFO - Stopping packet capture (PID: 111385)...
2025-07-16 14:40:32,175 - __main__ - INFO - Packet capture stopped.
2025-07-16 14:40:32,175 - __main__ - INFO - Phase 3.2: Adversarial DDoS Attacks...
2025-07-16 14:40:32,175 - __main__ - INFO - Timeline updated: ad_syn phase started at 1752648032.1755536
2025-07-16 16:40:45,728 - __main__ - INFO - Stopping packet capture (PID: 111397)...
2025-07-16 16:40:45,768 - __main__ - INFO - Packet capture stopped.
2025-07-16 16:40:45,768 - __main__ - INFO - Timeline updated: ad_udp phase started at 1752655245.768281
2025-07-16 18:00:53,607 - __main__ - INFO - Stopping packet capture (PID: 112012)...
2025-07-16 18:00:53,644 - __main__ - INFO - Packet capture stopped.
2025-07-16 18:00:53,644 - __main__ - INFO - Timeline updated: ad_slow phase started at 1752660053.6446626
2025-07-16 18:00:59,812 - __main__ - INFO - Proceeding with adversarial slow attack (no HTTP server required)
2025-07-16 18:00:59,812 - __main__ - INFO - Attack traffic will be captured via h6_slow_read.pcap and ad_slow.pcap
2025-07-16 20:01:12,554 - __main__ - INFO - Stopping packet capture (PID: 112420)...
2025-07-16 20:01:12,593 - __main__ - INFO - Packet capture stopped.
2025-07-16 20:01:12,593 - __main__ - INFO - Stopping packet capture (PID: 112419)...
2025-07-16 20:01:12,667 - __main__ - INFO - Packet capture stopped.
2025-07-16 20:01:12,667 - __main__ - INFO - Analyzing main_output/h6_slow_read.pcap for TCP issues...
2025-07-16 20:01:12,668 - __main__ - INFO - TCP Analysis on h6 PCAP: RST Count = 0, Retransmission Count = 0
2025-07-16 20:01:12,669 - __main__ - WARNING - Inter-Packet Arrival Time analysis failed for h6 PCAP: Not enough packets
2025-07-16 20:01:12,669 - __main__ - INFO - No HTTP server cleanup required.
2025-07-16 20:01:12,669 - __main__ - INFO - Phase 4: Cooldown (5s)...
2025-07-16 20:01:12,669 - __main__ - INFO - Timeline updated: normal phase started at 1752667272.6692843
2025-07-16 20:01:17,677 - __main__ - INFO - Signaling flow collection thread to stop...
2025-07-16 20:01:17,677 - __main__ - INFO - Waiting for flow collection thread to finish...
2025-07-16 20:01:18,490 - __main__ - INFO - Flow collection received stop signal, ending gracefully.
2025-07-16 20:01:18,490 - __main__ - INFO - Flow timeline collection completed.
2025-07-16 20:01:28,512 - __main__ - INFO - Flow statistics saved to main_output/flow_features.csv
2025-07-16 20:01:29,093 - __main__ - INFO - Flow collection thread finished successfully
2025-07-16 20:01:29,093 - __main__ - INFO - ============================================================
2025-07-16 20:01:29,093 - __main__ - INFO - COMPREHENSIVE TIMING SUMMARY
2025-07-16 20:01:29,093 - __main__ - INFO - ============================================================
2025-07-16 20:01:29,093 - __main__ - INFO - Configuration File: /home/user/Desktop/dataset_generation/config.json
2025-07-16 20:01:29,093 - __main__ - INFO - 
2025-07-16 20:01:29,093 - __main__ - INFO - Total Scenario Runtime: 23783.07 seconds (396.38 minutes)
2025-07-16 20:01:29,093 - __main__ - INFO - 
2025-07-16 20:01:29,093 - __main__ - INFO - Phase-by-Phase Breakdown:
2025-07-16 20:01:29,093 - __main__ - INFO -   Normal Traffic: 3604.20s (configured: 3600s)
2025-07-16 20:01:29,093 - __main__ - INFO -   Enhanced Traditional Attacks:
2025-07-16 20:01:29,093 - __main__ - INFO -     Enhanced Syn Flood: 304.66s (configured: 300s)
2025-07-16 20:01:29,093 - __main__ - INFO -     Enhanced Udp Flood: 307.60s (configured: 300s)
2025-07-16 20:01:29,094 - __main__ - INFO -     Enhanced Icmp Flood: 304.68s (configured: 300s)
2025-07-16 20:01:29,094 - __main__ - INFO -   Adversarial Attacks:
2025-07-16 20:01:29,094 - __main__ - INFO -     TCP State Exhaustion: 7213.59s (configured: 7200s)
2025-07-16 20:01:29,094 - __main__ - INFO -     Application Layer: 4807.88s (configured: 4800s)
2025-07-16 20:01:29,094 - __main__ - INFO -     Slow Read: 7219.02s (configured: 7200s)
2025-07-16 20:01:29,094 - __main__ - INFO -   Initialization: 5.01s (configured: 5s)
2025-07-16 20:01:29,094 - __main__ - INFO -   Cooldown: 5.01s (configured: 5s)
2025-07-16 20:01:29,094 - __main__ - INFO - ============================================================
2025-07-16 20:01:29,094 - __main__ - INFO - Traffic generation scenario finished.
2025-07-16 20:01:29 - [MAIN] - INFO - PCAP generation complete.
2025-07-16 20:01:29 - [MAIN] - INFO - Processing 8 PCAP files using 4 CPU cores...
2025-07-16 20:01:29,095 - __main__ - INFO - Starting parallel PCAP processing with 4 workers...
2025-07-16 20:01:47,907 - __main__ - INFO - ✓ Completed processing normal.pcap (24116 records)
2025-07-16 20:01:47,907 - __main__ - INFO - ✓ Completed processing syn_flood.pcap (5517 records)
2025-07-16 20:01:47,908 - __main__ - INFO - ✓ Completed processing udp_flood.pcap (3418 records)
2025-07-16 20:01:47,908 - __main__ - INFO - ✓ Completed processing icmp_flood.pcap (5640 records)
2025-07-16 20:01:47,908 - __main__ - INFO - ✓ Completed processing ad_syn.pcap (1150 records)
2025-07-16 20:01:47,908 - __main__ - INFO - ✓ Completed processing ad_udp.pcap (2020 records)
2025-07-16 20:01:47,908 - __main__ - INFO - ✓ Completed processing ad_slow.pcap (2859 records)
2025-07-16 20:01:47,908 - __main__ - INFO - ✓ Completed processing h6_slow_read.pcap (0 records)
2025-07-16 20:01:47,941 - __main__ - INFO - Parallel PCAP processing completed. Processed 8 files successfully.
2025-07-16 20:01:47 - [MAIN] - INFO - Parallel PCAP processing completed in 18.85 seconds (0.31 minutes)
2025-07-16 20:01:48 - [MAIN] - INFO - Combined labeled CSV generated at: main_output/packet_features.csv
2025-07-16 20:01:48 - [MAIN] - INFO - Final combined CSV created successfully.
2025-07-16 20:01:48 - [MAIN] - INFO - 
--- Packet Feature Counts by Class ---
2025-07-16 20:01:48 - [MAIN] - INFO -   normal: 24116 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   icmp_flood: 5640 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   syn_flood: 5517 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   udp_flood: 3418 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   unknown: 2471 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   ad_udp: 1534 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   ad_slow: 1428 packets
2025-07-16 20:01:48 - [MAIN] - INFO -   ad_syn: 596 packets
2025-07-16 20:01:48 - [MAIN] - INFO - Flow-level dataset generated at: main_output/flow_features.csv
2025-07-16 20:01:49 - [MAIN] - INFO - 
--- Flow Feature Counts by Class ---
2025-07-16 20:01:49 - [MAIN] - INFO -   ad_slow: 205127 flows
2025-07-16 20:01:49 - [MAIN] - INFO -   ad_syn: 197718 flows
2025-07-16 20:01:49 - [MAIN] - INFO -   ad_udp: 133207 flows
2025-07-16 20:01:49 - [MAIN] - INFO -   normal: 111197 flows
2025-07-16 20:01:49 - [MAIN] - INFO -   udp_flood: 9486 flows
2025-07-16 20:01:49 - [MAIN] - INFO -   icmp_flood: 9362 flows
2025-07-16 20:01:49 - [MAIN] - INFO -   syn_flood: 9362 flows
2025-07-16 20:01:49 - [MAIN] - INFO - Generating dataset summary...
2025-07-16 20:01:49 - [MAIN] - INFO - Dataset generation summary displayed above
2025-07-16 20:01:49 - [MAIN] - INFO - Running timeline analysis...
2025-07-16 20:01:49 - [MAIN] - INFO - Starting timeline analysis...
2025-07-16 20:01:51 - [MAIN] - INFO - Timeline Analysis Results:
2025-07-16 20:01:51 - [MAIN] - INFO -   Total attack types: 8
2025-07-16 20:01:51 - [MAIN] - INFO -   Good alignment: 3
2025-07-16 20:01:51 - [MAIN] - INFO -   Overall score: 37.5%
2025-07-16 20:01:51 - [MAIN] - INFO -   Status: ❌ POOR: Timeline alignment has major issues that need fixing.
2025-07-16 20:01:51 - [MAIN] - WARNING - Missing in flow data: unknown
2025-07-16 20:01:51 - [MAIN] - WARNING - Poor alignment: ad_slow, ad_syn, ad_udp, normal
2025-07-16 20:01:51 - [MAIN] - INFO - 
================================================================================
2025-07-16 20:01:51 - [MAIN] - INFO - 📊 DETAILED TIMELINE ANALYSIS REPORT
2025-07-16 20:01:51 - [MAIN] - INFO - ================================================================================
2025-07-16 20:01:51 - [MAIN] - INFO - Attack Type     Packet Timeline           Flow Timeline             Overlap    Status              
2025-07-16 20:01:51 - [MAIN] - INFO - ----------------------------------------------------------------------------------------------------
2025-07-16 20:01:51 - [MAIN] - INFO - ad_slow         3599.2s (1428 entries)    7218.8s (205127 entries)  3599.2s    ⚠️  TIMING OFFSET   
2025-07-16 20:01:51 - [MAIN] - INFO - ad_syn          3599.4s (596 entries)     7213.1s (197718 entries)  3599.4s    ⚠️  TIMING OFFSET   
2025-07-16 20:01:51 - [MAIN] - INFO - ad_udp          3594.0s (1534 entries)    4806.1s (133207 entries)  3594.0s    ⚠️  TIMING OFFSET   
2025-07-16 20:01:51 - [MAIN] - INFO - icmp_flood      297.3s (5640 entries)     303.3s (9362 entries)     297.3s     ✅ EXCELLENT MATCH   
2025-07-16 20:01:51 - [MAIN] - INFO - normal          3599.3s (24116 entries)   23766.4s (111197 entries) 3599.3s    ⚠️  TIMING OFFSET   
2025-07-16 20:01:51 - [MAIN] - INFO - syn_flood       298.0s (5517 entries)     303.5s (9362 entries)     297.6s     ✅ EXCELLENT MATCH   
2025-07-16 20:01:51 - [MAIN] - INFO - udp_flood       299.4s (3418 entries)     307.2s (9486 entries)     299.4s     ✅ EXCELLENT MATCH   
2025-07-16 20:01:51 - [MAIN] - INFO - unknown         15617.8s (2471 entries)   MISSING                   NONE       ❌ MISSING IN FLOW   
2025-07-16 20:01:51 - [MAIN] - INFO - 
================================================================================
2025-07-16 20:01:51 - [MAIN] - INFO - 🕐 DETAILED TIMING INFORMATION
2025-07-16 20:01:51 - [MAIN] - INFO - ================================================================================
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 AD_SLOW:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 18:00:59.814 - 19:00:59.045 (3599.2s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   18:00:53.705 - 20:01:12.462 (7218.8s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±6.1s, End±3613.4s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 AD_SYN:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 14:40:38.268 - 15:40:37.676 (3599.4s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   14:40:32.489 - 16:40:45.619 (7213.1s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±5.8s, End±3607.9s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 AD_UDP:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 16:40:49.847 - 17:40:43.834 (3594.0s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   16:40:46.623 - 18:00:52.697 (4806.1s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±3.2s, End±1208.9s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 ICMP_FLOOD:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 14:35:34.156 - 14:40:31.443 (297.3s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   14:35:28.154 - 14:40:31.481 (303.3s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±6.0s, End±0.0s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 NORMAL:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 13:25:15.052 - 14:25:14.342 (3599.3s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   13:25:11.041 - 20:01:17.488 (23766.4s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±4.0s, End±20163.1s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 SYN_FLOOD:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 14:25:21.318 - 14:30:19.295 (298.0s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   14:25:15.426 - 14:30:18.889 (303.5s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±5.9s, End±0.4s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 UDP_FLOOD:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 14:30:27.477 - 14:35:26.914 (299.4s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   14:30:19.910 - 14:35:27.142 (307.2s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Gap:    Start±7.6s, End±0.2s
2025-07-16 20:01:51 - [MAIN] - INFO - 
📍 UNKNOWN:
2025-07-16 20:01:51 - [MAIN] - INFO -    Packet: 15:40:52.629 - 20:01:10.459 (15617.8s)
2025-07-16 20:01:51 - [MAIN] - INFO -    Flow:   MISSING
2025-07-16 20:01:51 - [MAIN] - INFO - ================================================================================
2025-07-16 20:01:51 - [MAIN] - INFO - ============================================================
2025-07-16 20:01:51 - [MAIN] - INFO - FINAL EXECUTION SUMMARY
2025-07-16 20:01:51 - [MAIN] - INFO - ============================================================
2025-07-16 20:01:51 - [MAIN] - INFO - Total Execution Time: 23815.69 seconds (396.93 minutes | 6.62 hours)
2025-07-16 20:01:51 - [MAIN] - INFO - Dataset Generation Complete: 2025-07-16 20:01:51
2025-07-16 20:01:51 - [MAIN] - INFO - Timeline Alignment Score: 37.5%
2025-07-16 20:01:51 - [MAIN] - INFO - ❌ Timeline Quality: POOR - Requires attention
2025-07-16 20:01:51 - [MAIN] - INFO - ============================================================
2025-07-16 20:01:51,456 - __main__ - INFO - Cleaning up resources...
2025-07-16 20:01:51,456 - __main__ - INFO - Terminating Ryu controller (PID: 87560)...
2025-07-16 20:01:51,460 - __main__ - INFO - Cleaning up Mininet environment...
2025-07-16 20:01:53,085 - __main__ - INFO - Cleanup complete.
