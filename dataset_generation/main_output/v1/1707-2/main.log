2025-07-17 08:48:59 - [MAIN] - INFO - Cleaning up any previous Mininet instances...
2025-07-17 08:49:01 - [MAIN] - INFO - Mininet cleanup complete.
2025-07-17 08:49:01,048 - __main__ - INFO - Verifying required tools...
2025-07-17 08:49:01,295 - __main__ - INFO - TShark version: Running as user "root" and group "root". This could be dangerous.
2025-07-17 08:49:01,295 - __main__ - INFO - All required tools are available.
2025-07-17 08:49:01 - [MAIN] - INFO - Using configuration file: /home/user/Desktop/dataset_generation/config.json
2025-07-17 08:49:01,296 - __main__ - INFO - Starting Ryu SDN controller...
2025-07-17 08:49:01,302 - __main__ - INFO - Ryu controller started with PID: 9954. See main_output/ryu.log for logs.
2025-07-17 08:49:01,302 - __main__ - INFO - Checking for controller on port 6653 (timeout: 30s)...
2025-07-17 08:49:02,319 - __main__ - INFO - Controller is up and listening.
2025-07-17 08:49:02 - [MAIN] - INFO - Testing /hello endpoint...
2025-07-17 08:49:02 - [MAIN] - INFO - Test /hello endpoint: PASSED
2025-07-17 08:49:02,326 - __main__ - INFO - Setting up Mininet topology...
2025-07-17 08:49:02,572 - __main__ - INFO - Mininet version: 
2025-07-17 08:49:02,580 - __main__ - INFO - Connecting to remote controller at 127.0.0.1:6653
2025-07-17 08:49:04,867 - __main__ - INFO - Mininet network started successfully.
2025-07-17 08:49:04,867 - __main__ - INFO - Running Mininet pingall test...
2025-07-17 08:49:09,956 - __main__ - INFO - Mininet pingall test completed successfully. Packet loss: 0.0%
2025-07-17 08:49:09,956 - __main__ - INFO - Starting traffic generation scenario...
2025-07-17 08:49:09,956 - __main__ - INFO - Phase 1: Initialization (5s)...
2025-07-17 08:49:14,962 - __main__ - INFO - Starting flow statistics collection for 23825 seconds...
2025-07-17 08:49:14,962 - __main__ - INFO - Flow statistics collection started in background.
2025-07-17 08:49:14,964 - __main__ - INFO - Phase 2: Normal Traffic (3600s)...
2025-07-17 08:49:14,965 - __main__ - INFO - Timeline updated: normal phase started at 1752713354.9650154
2025-07-17 09:49:36,778 - __main__ - INFO - Stopping packet capture (PID: 10218)...
2025-07-17 09:49:36,859 - __main__ - INFO - Packet capture stopped.
2025-07-17 09:49:36,859 - __main__ - INFO - Phase 3.1: Enhanced Traditional DDoS Attacks...
2025-07-17 09:49:36,859 - __main__ - INFO - Timeline updated: syn_flood phase started at 1752716976.8598473
2025-07-17 09:54:41,449 - __main__ - INFO - Stopping packet capture (PID: 33831)...
2025-07-17 09:54:41,545 - __main__ - INFO - Packet capture stopped.
2025-07-17 09:54:41,545 - __main__ - INFO - Timeline updated: udp_flood phase started at 1752717281.5455668
2025-07-17 09:59:49,172 - __main__ - INFO - Stopping packet capture (PID: 33855)...
2025-07-17 09:59:49,258 - __main__ - INFO - Packet capture stopped.
2025-07-17 09:59:49,259 - __main__ - INFO - Timeline updated: icmp_flood phase started at 1752717589.2590768
2025-07-17 10:04:53,809 - __main__ - INFO - Stopping packet capture (PID: 33872)...
2025-07-17 10:04:53,871 - __main__ - INFO - Packet capture stopped.
2025-07-17 10:04:53,871 - __main__ - INFO - Phase 3.2: Adversarial DDoS Attacks...
2025-07-17 10:04:53,871 - __main__ - INFO - Timeline updated: ad_syn phase started at 1752717893.8715541
2025-07-17 12:05:02,160 - __main__ - INFO - Stopping packet capture (PID: 33897)...
2025-07-17 12:05:02,233 - __main__ - INFO - Packet capture stopped.
2025-07-17 12:05:02,234 - __main__ - INFO - Timeline updated: ad_udp phase started at 1752725102.234042
2025-07-17 13:25:11,622 - __main__ - INFO - Stopping packet capture (PID: 34510)...
2025-07-17 13:25:11,694 - __main__ - INFO - Packet capture stopped.
2025-07-17 13:25:11,694 - __main__ - INFO - Timeline updated: ad_slow phase started at 1752729911.6949253
2025-07-17 13:25:17,867 - __main__ - INFO - Proceeding with adversarial slow attack (no HTTP server required)
2025-07-17 13:25:17,867 - __main__ - INFO - Attack traffic will be captured via h6_slow_read.pcap and ad_slow.pcap
2025-07-17 15:25:31,650 - __main__ - INFO - Stopping packet capture (PID: 35060)...
2025-07-17 15:25:31,724 - __main__ - INFO - Packet capture stopped.
2025-07-17 15:25:31,724 - __main__ - INFO - Stopping packet capture (PID: 35059)...
2025-07-17 15:25:31,798 - __main__ - INFO - Packet capture stopped.
2025-07-17 15:25:31,798 - __main__ - INFO - Analyzing main_output/h6_slow_read.pcap for TCP issues...
2025-07-17 15:25:31,799 - __main__ - INFO - TCP Analysis on h6 PCAP: RST Count = 0, Retransmission Count = 0
2025-07-17 15:25:31,799 - __main__ - WARNING - Inter-Packet Arrival Time analysis failed for h6 PCAP: Not enough packets
2025-07-17 15:25:31,799 - __main__ - INFO - No HTTP server cleanup required.
2025-07-17 15:25:31,799 - __main__ - INFO - Phase 4: Cooldown (5s)...
2025-07-17 15:25:31,799 - __main__ - INFO - Timeline updated: normal phase started at 1752737131.799622
2025-07-17 15:25:36,805 - __main__ - INFO - Signaling flow collection thread to stop...
2025-07-17 15:25:36,805 - __main__ - INFO - Waiting for flow collection thread to finish...
2025-07-17 15:25:37,806 - __main__ - INFO - Flow collection received stop signal, ending gracefully.
2025-07-17 15:25:37,806 - __main__ - INFO - Flow timeline collection completed.
2025-07-17 15:25:47,555 - __main__ - INFO - Flow statistics saved to main_output/flow_features.csv
2025-07-17 15:25:48,134 - __main__ - INFO - Flow collection thread finished successfully
2025-07-17 15:25:48,135 - __main__ - INFO - ============================================================
2025-07-17 15:25:48,135 - __main__ - INFO - COMPREHENSIVE TIMING SUMMARY
2025-07-17 15:25:48,135 - __main__ - INFO - ============================================================
2025-07-17 15:25:48,135 - __main__ - INFO - Configuration File: /home/user/Desktop/dataset_generation/config.json
2025-07-17 15:25:48,135 - __main__ - INFO - 
2025-07-17 15:25:48,135 - __main__ - INFO - Total Scenario Runtime: 23798.18 seconds (396.64 minutes)
2025-07-17 15:25:48,135 - __main__ - INFO - 
2025-07-17 15:25:48,135 - __main__ - INFO - Phase-by-Phase Breakdown:
2025-07-17 15:25:48,135 - __main__ - INFO -   Normal Traffic: 3621.89s (configured: 3600s)
2025-07-17 15:25:48,135 - __main__ - INFO -   Enhanced Traditional Attacks:
2025-07-17 15:25:48,135 - __main__ - INFO -     Enhanced Syn Flood: 304.69s (configured: 300s)
2025-07-17 15:25:48,135 - __main__ - INFO -     Enhanced Udp Flood: 307.71s (configured: 300s)
2025-07-17 15:25:48,135 - __main__ - INFO -     Enhanced Icmp Flood: 304.61s (configured: 300s)
2025-07-17 15:25:48,135 - __main__ - INFO -   Adversarial Attacks:
2025-07-17 15:25:48,135 - __main__ - INFO -     TCP State Exhaustion: 7208.36s (configured: 7200s)
2025-07-17 15:25:48,135 - __main__ - INFO -     Application Layer: 4809.46s (configured: 4800s)
2025-07-17 15:25:48,135 - __main__ - INFO -     Slow Read: 7220.10s (configured: 7200s)
2025-07-17 15:25:48,135 - __main__ - INFO -   Initialization: 5.01s (configured: 5s)
2025-07-17 15:25:48,135 - __main__ - INFO -   Cooldown: 5.01s (configured: 5s)
2025-07-17 15:25:48,135 - __main__ - INFO - ============================================================
2025-07-17 15:25:48,135 - __main__ - INFO - Traffic generation scenario finished.
2025-07-17 15:25:48 - [MAIN] - INFO - PCAP generation complete.
2025-07-17 15:25:48 - [MAIN] - INFO - Processing 8 PCAP files using 4 CPU cores...
2025-07-17 15:25:48,137 - __main__ - INFO - Starting parallel PCAP processing with 4 workers...
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing normal.pcap (24080 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing syn_flood.pcap (5505 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing udp_flood.pcap (3428 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing icmp_flood.pcap (5524 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing ad_syn.pcap (1096 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing ad_udp.pcap (1948 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing ad_slow.pcap (2823 records)
2025-07-17 15:26:07,787 - __main__ - INFO - ✓ Completed processing h6_slow_read.pcap (0 records)
2025-07-17 15:26:07,818 - __main__ - INFO - Parallel PCAP processing completed. Processed 8 files successfully.
2025-07-17 15:26:07 - [MAIN] - INFO - Parallel PCAP processing completed in 19.68 seconds (0.33 minutes)
2025-07-17 15:26:08 - [MAIN] - INFO - Combined labeled CSV generated at: main_output/packet_features.csv
2025-07-17 15:26:08 - [MAIN] - INFO - Final combined CSV created successfully.
2025-07-17 15:26:08 - [MAIN] - INFO - 
--- Packet Feature Counts by Class ---
2025-07-17 15:26:08 - [MAIN] - INFO -   normal: 23976 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   icmp_flood: 5524 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   syn_flood: 5505 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   udp_flood: 3428 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   unknown: 2531 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   ad_slow: 1439 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   ad_udp: 1434 packets
2025-07-17 15:26:08 - [MAIN] - INFO -   ad_syn: 567 packets
2025-07-17 15:26:08 - [MAIN] - INFO - Flow-level dataset generated at: main_output/flow_features.csv
2025-07-17 15:26:09 - [MAIN] - INFO - 
--- Flow Feature Counts by Class ---
2025-07-17 15:26:09 - [MAIN] - INFO -   ad_slow: 204848 flows
2025-07-17 15:26:09 - [MAIN] - INFO -   ad_syn: 196416 flows
2025-07-17 15:26:09 - [MAIN] - INFO -   ad_udp: 132556 flows
2025-07-17 15:26:09 - [MAIN] - INFO -   normal: 111755 flows
2025-07-17 15:26:09 - [MAIN] - INFO -   udp_flood: 9486 flows
2025-07-17 15:26:09 - [MAIN] - INFO -   icmp_flood: 9362 flows
2025-07-17 15:26:09 - [MAIN] - INFO -   syn_flood: 9362 flows
2025-07-17 15:26:09 - [MAIN] - INFO - Generating dataset summary...
2025-07-17 15:26:09 - [MAIN] - INFO - Dataset generation summary displayed above
2025-07-17 15:26:09 - [MAIN] - INFO - Running timeline analysis...
2025-07-17 15:26:09 - [MAIN] - INFO - Starting timeline analysis...
2025-07-17 15:26:11 - [MAIN] - INFO - Timeline Analysis Results:
2025-07-17 15:26:11 - [MAIN] - INFO -   Total attack types: 8
2025-07-17 15:26:11 - [MAIN] - INFO -   Good alignment: 3
2025-07-17 15:26:11 - [MAIN] - INFO -   Overall score: 37.5%
2025-07-17 15:26:11 - [MAIN] - INFO -   Status: ❌ POOR: Timeline alignment has major issues that need fixing.
2025-07-17 15:26:11 - [MAIN] - WARNING - Missing in flow data: unknown
2025-07-17 15:26:11 - [MAIN] - WARNING - Poor alignment: ad_slow, ad_syn, ad_udp, normal
2025-07-17 15:26:11 - [MAIN] - INFO - 
================================================================================
2025-07-17 15:26:11 - [MAIN] - INFO - 📊 DETAILED TIMELINE ANALYSIS REPORT
2025-07-17 15:26:11 - [MAIN] - INFO - ================================================================================
2025-07-17 15:26:11 - [MAIN] - INFO - Attack Type     Packet Timeline           Flow Timeline             Overlap    Status              
2025-07-17 15:26:11 - [MAIN] - INFO - ----------------------------------------------------------------------------------------------------
2025-07-17 15:26:11 - [MAIN] - INFO - ad_slow         3599.1s (1439 entries)    7220.0s (204848 entries)  3599.1s    ⚠️  TIMING OFFSET   
2025-07-17 15:26:11 - [MAIN] - INFO - ad_syn          3594.4s (567 entries)     7207.7s (196416 entries)  3594.4s    ⚠️  TIMING OFFSET   
2025-07-17 15:26:11 - [MAIN] - INFO - ad_udp          3598.9s (1434 entries)    4807.6s (132556 entries)  3598.9s    ⚠️  TIMING OFFSET   
2025-07-17 15:26:11 - [MAIN] - INFO - icmp_flood      297.3s (5524 entries)     303.4s (9362 entries)     297.3s     ✅ EXCELLENT MATCH   
2025-07-17 15:26:11 - [MAIN] - INFO - normal          3599.9s (23976 entries)   23781.8s (111755 entries) 3599.9s    ⚠️  TIMING OFFSET   
2025-07-17 15:26:11 - [MAIN] - INFO - syn_flood       297.9s (5505 entries)     303.3s (9362 entries)     297.8s     ✅ EXCELLENT MATCH   
2025-07-17 15:26:11 - [MAIN] - INFO - udp_flood       299.4s (3428 entries)     307.3s (9486 entries)     299.4s     ✅ EXCELLENT MATCH   
2025-07-17 15:26:11 - [MAIN] - INFO - unknown         20170.1s (2531 entries)   MISSING                   NONE       ❌ MISSING IN FLOW   
2025-07-17 15:26:11 - [MAIN] - INFO - 
================================================================================
2025-07-17 15:26:11 - [MAIN] - INFO - 🕐 DETAILED TIMING INFORMATION
2025-07-17 15:26:11 - [MAIN] - INFO - ================================================================================
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 AD_SLOW:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 13:25:17.868 - 14:25:16.971 (3599.1s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   13:25:11.785 - 15:25:31.774 (7220.0s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±6.1s, End±3614.8s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 AD_SYN:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 10:05:00.100 - 11:04:54.451 (3594.4s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   10:04:54.512 - 12:05:02.179 (7207.7s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±5.6s, End±3607.7s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 AD_UDP:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 12:05:06.314 - 13:05:05.242 (3598.9s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   12:05:03.186 - 13:25:10.779 (4807.6s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±3.1s, End±1205.5s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 ICMP_FLOOD:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 09:59:55.914 - 10:04:53.176 (297.3s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   09:59:50.124 - 10:04:53.501 (303.4s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±5.8s, End±0.3s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 NORMAL:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 08:49:18.989 - 09:49:18.902 (3599.9s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   08:49:14.971 - 15:25:36.802 (23781.8s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±4.0s, End±20177.9s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 SYN_FLOOD:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 09:49:43.003 - 09:54:40.939 (297.9s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   09:49:37.448 - 09:54:40.762 (303.3s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±5.6s, End±0.2s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 UDP_FLOOD:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 09:54:49.163 - 09:59:48.593 (299.4s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   09:54:41.771 - 09:59:49.119 (307.3s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Gap:    Start±7.4s, End±0.5s
2025-07-17 15:26:11 - [MAIN] - INFO - 
📍 UNKNOWN:
2025-07-17 15:26:11 - [MAIN] - INFO -    Packet: 09:49:19.541 - 15:25:29.594 (20170.1s)
2025-07-17 15:26:11 - [MAIN] - INFO -    Flow:   MISSING
2025-07-17 15:26:11 - [MAIN] - INFO - ================================================================================
2025-07-17 15:26:11 - [MAIN] - INFO - ============================================================
2025-07-17 15:26:11 - [MAIN] - INFO - FINAL EXECUTION SUMMARY
2025-07-17 15:26:11 - [MAIN] - INFO - ============================================================
2025-07-17 15:26:11 - [MAIN] - INFO - Total Execution Time: 23831.66 seconds (397.19 minutes | 6.62 hours)
2025-07-17 15:26:11 - [MAIN] - INFO - Dataset Generation Complete: 2025-07-17 15:26:11
2025-07-17 15:26:11 - [MAIN] - INFO - Timeline Alignment Score: 37.5%
2025-07-17 15:26:11 - [MAIN] - INFO - ❌ Timeline Quality: POOR - Requires attention
2025-07-17 15:26:11 - [MAIN] - INFO - ============================================================
2025-07-17 15:26:11,336 - __main__ - INFO - Cleaning up resources...
2025-07-17 15:26:11,336 - __main__ - INFO - Terminating Ryu controller (PID: 9954)...
2025-07-17 15:26:11,339 - __main__ - INFO - Cleaning up Mininet environment...
2025-07-17 15:26:13,049 - __main__ - INFO - Cleanup complete.
