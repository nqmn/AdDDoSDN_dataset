2025-07-18 14:10:36 - [MAIN] - INFO - Cleaning up any previous Mininet instances...
2025-07-18 14:10:37 - [MAIN] - INFO - Mininet cleanup complete.
2025-07-18 14:10:37,701 - __main__ - INFO - Verifying required tools...
2025-07-18 14:10:37,964 - __main__ - INFO - TShark version: Running as user "root" and group "root". This could be dangerous.
2025-07-18 14:10:37,964 - __main__ - INFO - All required tools are available.
2025-07-18 14:10:37 - [MAIN] - INFO - Using configuration file: /home/user/Desktop/dataset_generation/config.json
2025-07-18 14:10:37,965 - __main__ - INFO - Starting Ryu SDN controller...
2025-07-18 14:10:37,971 - __main__ - INFO - Ryu controller started with PID: 41507. See main_output/ryu.log for logs.
2025-07-18 14:10:37,971 - __main__ - INFO - Checking for controller on port 6653 (timeout: 30s)...
2025-07-18 14:10:38,987 - __main__ - INFO - Controller is up and listening.
2025-07-18 14:10:38 - [MAIN] - INFO - Testing /hello endpoint...
2025-07-18 14:10:38 - [MAIN] - INFO - Test /hello endpoint: PASSED
2025-07-18 14:10:38,994 - __main__ - INFO - Setting up Mininet topology...
2025-07-18 14:10:39,248 - __main__ - INFO - Mininet version: 
2025-07-18 14:10:39,256 - __main__ - INFO - Connecting to remote controller at 127.0.0.1:6653
2025-07-18 14:10:39,525 - __main__ - INFO - Mininet network started successfully.
2025-07-18 14:10:39,525 - __main__ - INFO - Running Mininet pingall test...
2025-07-18 14:10:44,615 - __main__ - INFO - Mininet pingall test completed successfully. Packet loss: 0.0%
2025-07-18 14:10:44,616 - __main__ - INFO - Starting traffic generation scenario...
2025-07-18 14:10:44,616 - __main__ - INFO - Phase 1: Initialization (5s)...
2025-07-18 14:10:49,621 - __main__ - INFO - Starting flow statistics collection for 23825 seconds...
2025-07-18 14:10:49,622 - __main__ - INFO - Flow statistics collection started in background.
2025-07-18 14:10:49,624 - __main__ - INFO - Phase 2: Normal Traffic (3600s)...
2025-07-18 14:10:49,624 - __main__ - INFO - Timeline updated: normal phase started at 1752819049.6244218
2025-07-18 15:11:06,408 - __main__ - INFO - Stopping packet capture (PID: 41772)...
2025-07-18 15:11:06,488 - __main__ - INFO - Packet capture stopped.
2025-07-18 15:11:06,488 - __main__ - INFO - Phase 3.1: Enhanced Traditional DDoS Attacks...
2025-07-18 15:11:06,488 - __main__ - INFO - Timeline updated: syn_flood phase started at 1752822666.4889026
2025-07-18 15:16:11,082 - __main__ - INFO - Stopping packet capture (PID: 65209)...
2025-07-18 15:16:11,218 - __main__ - INFO - Packet capture stopped.
2025-07-18 15:16:11,219 - __main__ - INFO - Timeline updated: udp_flood phase started at 1752822971.2190506
2025-07-18 15:21:18,753 - __main__ - INFO - Stopping packet capture (PID: 65236)...
2025-07-18 15:21:18,834 - __main__ - INFO - Packet capture stopped.
2025-07-18 15:21:18,834 - __main__ - INFO - Timeline updated: icmp_flood phase started at 1752823278.8347228
2025-07-18 15:26:23,392 - __main__ - INFO - Stopping packet capture (PID: 65252)...
2025-07-18 15:26:23,488 - __main__ - INFO - Packet capture stopped.
2025-07-18 15:26:23,488 - __main__ - INFO - Phase 3.2: Adversarial DDoS Attacks...
2025-07-18 15:26:23,489 - __main__ - INFO - Timeline updated: ad_syn phase started at 1752823583.489035
2025-07-18 17:26:41,780 - __main__ - INFO - Stopping packet capture (PID: 65268)...
2025-07-18 17:26:41,851 - __main__ - INFO - Packet capture stopped.
2025-07-18 17:26:41,851 - __main__ - INFO - Timeline updated: ad_udp phase started at 1752830801.8519473
2025-07-18 18:46:51,036 - __main__ - INFO - Stopping packet capture (PID: 65919)...
2025-07-18 18:46:51,075 - __main__ - INFO - Packet capture stopped.
2025-07-18 18:46:51,076 - __main__ - INFO - Timeline updated: ad_slow phase started at 1752835611.07601
2025-07-18 18:46:57,225 - __main__ - INFO - Proceeding with adversarial slow attack (no HTTP server required)
2025-07-18 18:46:57,225 - __main__ - INFO - Attack traffic will be captured via h6_slow_read.pcap and ad_slow.pcap
2025-07-18 20:47:02,569 - __main__ - INFO - Stopping packet capture (PID: 66311)...
2025-07-18 20:47:02,645 - __main__ - INFO - Packet capture stopped.
2025-07-18 20:47:02,645 - __main__ - INFO - Stopping packet capture (PID: 66309)...
2025-07-18 20:47:02,720 - __main__ - INFO - Packet capture stopped.
2025-07-18 20:47:02,720 - __main__ - INFO - Analyzing main_output/h6_slow_read.pcap for TCP issues...
2025-07-18 20:47:02,721 - __main__ - INFO - TCP Analysis on h6 PCAP: RST Count = 0, Retransmission Count = 0
2025-07-18 20:47:02,722 - __main__ - WARNING - Inter-Packet Arrival Time analysis failed for h6 PCAP: Not enough packets
2025-07-18 20:47:02,722 - __main__ - INFO - No HTTP server cleanup required.
2025-07-18 20:47:02,722 - __main__ - INFO - Phase 4: Cooldown (5s)...
2025-07-18 20:47:02,722 - __main__ - INFO - Timeline updated: normal phase started at 1752842822.722289
2025-07-18 20:47:07,731 - __main__ - INFO - Signaling flow collection thread to stop...
2025-07-18 20:47:07,731 - __main__ - INFO - Waiting for flow collection thread to finish...
2025-07-18 20:47:07,863 - __main__ - INFO - Flow collection received stop signal, ending gracefully.
2025-07-18 20:47:07,863 - __main__ - INFO - Flow timeline collection completed.
2025-07-18 20:47:17,976 - __main__ - INFO - Flow statistics saved to main_output/flow_features.csv
2025-07-18 20:47:18,538 - __main__ - INFO - Flow collection thread finished successfully
2025-07-18 20:47:18,539 - __main__ - INFO - ============================================================
2025-07-18 20:47:18,539 - __main__ - INFO - COMPREHENSIVE TIMING SUMMARY
2025-07-18 20:47:18,539 - __main__ - INFO - ============================================================
2025-07-18 20:47:18,539 - __main__ - INFO - Configuration File: /home/user/Desktop/dataset_generation/config.json
2025-07-18 20:47:18,539 - __main__ - INFO - 
2025-07-18 20:47:18,539 - __main__ - INFO - Total Scenario Runtime: 23793.92 seconds (396.57 minutes)
2025-07-18 20:47:18,539 - __main__ - INFO - 
2025-07-18 20:47:18,539 - __main__ - INFO - Phase-by-Phase Breakdown:
2025-07-18 20:47:18,539 - __main__ - INFO -   Normal Traffic: 3616.86s (configured: 3600s)
2025-07-18 20:47:18,539 - __main__ - INFO -   Enhanced Traditional Attacks:
2025-07-18 20:47:18,539 - __main__ - INFO -     Enhanced Syn Flood: 304.73s (configured: 300s)
2025-07-18 20:47:18,539 - __main__ - INFO -     Enhanced Udp Flood: 307.62s (configured: 300s)
2025-07-18 20:47:18,539 - __main__ - INFO -     Enhanced Icmp Flood: 304.65s (configured: 300s)
2025-07-18 20:47:18,539 - __main__ - INFO -   Adversarial Attacks:
2025-07-18 20:47:18,539 - __main__ - INFO -     TCP State Exhaustion: 7218.36s (configured: 7200s)
2025-07-18 20:47:18,539 - __main__ - INFO -     Application Layer: 4809.22s (configured: 4800s)
2025-07-18 20:47:18,539 - __main__ - INFO -     Slow Read: 7211.64s (configured: 7200s)
2025-07-18 20:47:18,539 - __main__ - INFO -   Initialization: 5.01s (configured: 5s)
2025-07-18 20:47:18,539 - __main__ - INFO -   Cooldown: 5.01s (configured: 5s)
2025-07-18 20:47:18,539 - __main__ - INFO - ============================================================
2025-07-18 20:47:18,539 - __main__ - INFO - Traffic generation scenario finished.
2025-07-18 20:47:18 - [MAIN] - INFO - PCAP generation complete.
2025-07-18 20:47:18 - [MAIN] - INFO - Processing 8 PCAP files using 4 CPU cores...
2025-07-18 20:47:18,541 - __main__ - INFO - Starting parallel PCAP processing with 4 workers...
2025-07-18 20:47:37,191 - __main__ - INFO - ✓ Completed processing normal.pcap (24244 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing syn_flood.pcap (5569 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing udp_flood.pcap (3420 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing icmp_flood.pcap (5588 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing ad_syn.pcap (1231 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing ad_udp.pcap (1993 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing ad_slow.pcap (2786 records)
2025-07-18 20:47:37,192 - __main__ - INFO - ✓ Completed processing h6_slow_read.pcap (0 records)
2025-07-18 20:47:37,225 - __main__ - INFO - Parallel PCAP processing completed. Processed 8 files successfully.
2025-07-18 20:47:37 - [MAIN] - INFO - Parallel PCAP processing completed in 18.69 seconds (0.31 minutes)
2025-07-18 20:47:37 - [MAIN] - INFO - Combined labeled CSV generated at: main_output/packet_features.csv
2025-07-18 20:47:37 - [MAIN] - INFO - Final combined CSV created successfully.
2025-07-18 20:47:37 - [MAIN] - INFO - 
--- Packet Feature Counts by Class ---
2025-07-18 20:47:37 - [MAIN] - INFO -   normal: 24164 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   icmp_flood: 5588 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   syn_flood: 5569 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   udp_flood: 3420 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   unknown: 2519 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   ad_udp: 1514 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   ad_slow: 1409 packets
2025-07-18 20:47:37 - [MAIN] - INFO -   ad_syn: 648 packets
2025-07-18 20:47:37 - [MAIN] - INFO - Flow-level dataset generated at: main_output/flow_features.csv
2025-07-18 20:47:38 - [MAIN] - INFO - 
--- Flow Feature Counts by Class ---
2025-07-18 20:47:38 - [MAIN] - INFO -   ad_slow: 205530 flows
2025-07-18 20:47:38 - [MAIN] - INFO -   ad_syn: 199113 flows
2025-07-18 20:47:38 - [MAIN] - INFO -   ad_udp: 133207 flows
2025-07-18 20:47:38 - [MAIN] - INFO -   normal: 111600 flows
2025-07-18 20:47:38 - [MAIN] - INFO -   udp_flood: 9486 flows
2025-07-18 20:47:38 - [MAIN] - INFO -   syn_flood: 9362 flows
2025-07-18 20:47:38 - [MAIN] - INFO -   icmp_flood: 9362 flows
2025-07-18 20:47:38 - [MAIN] - INFO - Generating dataset summary...
2025-07-18 20:47:39 - [MAIN] - INFO - Dataset generation summary displayed above
2025-07-18 20:47:39 - [MAIN] - INFO - Running timeline analysis...
2025-07-18 20:47:39 - [MAIN] - INFO - Starting timeline analysis...
2025-07-18 20:47:40 - [MAIN] - INFO - Timeline Analysis Results:
2025-07-18 20:47:40 - [MAIN] - INFO -   Total attack types: 8
2025-07-18 20:47:40 - [MAIN] - INFO -   Good alignment: 3
2025-07-18 20:47:40 - [MAIN] - INFO -   Overall score: 37.5%
2025-07-18 20:47:40 - [MAIN] - INFO -   Status: ❌ POOR: Timeline alignment has major issues that need fixing.
2025-07-18 20:47:40 - [MAIN] - WARNING - Missing in flow data: unknown
2025-07-18 20:47:40 - [MAIN] - WARNING - Poor alignment: ad_slow, ad_syn, ad_udp, normal
2025-07-18 20:47:40 - [MAIN] - INFO - 
================================================================================
2025-07-18 20:47:40 - [MAIN] - INFO - 📊 DETAILED TIMELINE ANALYSIS REPORT
2025-07-18 20:47:40 - [MAIN] - INFO - ================================================================================
2025-07-18 20:47:40 - [MAIN] - INFO - Attack Type     Packet Timeline           Flow Timeline             Overlap    Status              
2025-07-18 20:47:40 - [MAIN] - INFO - ----------------------------------------------------------------------------------------------------
2025-07-18 20:47:40 - [MAIN] - INFO - ad_slow         3599.0s (1409 entries)    7209.8s (205530 entries)  3599.0s    ⚠️  TIMING OFFSET   
2025-07-18 20:47:40 - [MAIN] - INFO - ad_syn          3586.7s (648 entries)     7216.6s (199113 entries)  3586.7s    ⚠️  TIMING OFFSET   
2025-07-18 20:47:40 - [MAIN] - INFO - ad_udp          3592.9s (1514 entries)    4809.0s (133207 entries)  3592.9s    ⚠️  TIMING OFFSET   
2025-07-18 20:47:40 - [MAIN] - INFO - icmp_flood      297.2s (5588 entries)     303.6s (9362 entries)     297.2s     ✅ EXCELLENT MATCH   
2025-07-18 20:47:40 - [MAIN] - INFO - normal          3599.9s (24164 entries)   23777.2s (111600 entries) 3599.9s    ⚠️  TIMING OFFSET   
2025-07-18 20:47:40 - [MAIN] - INFO - syn_flood       297.9s (5569 entries)     303.3s (9362 entries)     297.8s     ✅ EXCELLENT MATCH   
2025-07-18 20:47:40 - [MAIN] - INFO - udp_flood       299.3s (3420 entries)     307.3s (9486 entries)     299.3s     ✅ EXCELLENT MATCH   
2025-07-18 20:47:40 - [MAIN] - INFO - unknown         20166.4s (2519 entries)   MISSING                   NONE       ❌ MISSING IN FLOW   
2025-07-18 20:47:40 - [MAIN] - INFO - 
================================================================================
2025-07-18 20:47:40 - [MAIN] - INFO - 🕐 DETAILED TIMING INFORMATION
2025-07-18 20:47:40 - [MAIN] - INFO - ================================================================================
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 AD_SLOW:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 18:46:57.227 - 19:46:56.276 (3599.0s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   18:46:52.042 - 20:47:01.823 (7209.8s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±5.2s, End±3605.5s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 AD_SYN:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 15:26:29.617 - 16:26:16.338 (3586.7s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   15:26:24.391 - 17:26:40.984 (7216.6s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±5.2s, End±3624.6s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 AD_UDP:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 17:26:45.921 - 18:26:38.774 (3592.9s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   17:26:41.990 - 18:46:51.036 (4809.0s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±3.9s, End±1212.3s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 ICMP_FLOOD:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 15:21:25.501 - 15:26:22.696 (297.2s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   15:21:19.757 - 15:26:23.384 (303.6s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±5.7s, End±0.7s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 NORMAL:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 14:10:53.641 - 15:10:53.492 (3599.9s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   14:10:49.631 - 20:47:06.858 (23777.2s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±4.0s, End±20173.4s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 SYN_FLOOD:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 15:11:12.630 - 15:16:10.565 (297.9s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   15:11:07.103 - 15:16:10.424 (303.3s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±5.5s, End±0.1s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 UDP_FLOOD:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 15:16:18.807 - 15:21:18.152 (299.3s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   15:16:11.432 - 15:21:18.747 (307.3s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Gap:    Start±7.4s, End±0.6s
2025-07-18 20:47:40 - [MAIN] - INFO - 
📍 UNKNOWN:
2025-07-18 20:47:40 - [MAIN] - INFO -    Packet: 15:10:54.112 - 20:47:00.474 (20166.4s)
2025-07-18 20:47:40 - [MAIN] - INFO -    Flow:   MISSING
2025-07-18 20:47:40 - [MAIN] - INFO - ================================================================================
2025-07-18 20:47:40 - [MAIN] - INFO - ============================================================
2025-07-18 20:47:40 - [MAIN] - INFO - FINAL EXECUTION SUMMARY
2025-07-18 20:47:40 - [MAIN] - INFO - ============================================================
2025-07-18 20:47:40 - [MAIN] - INFO - Total Execution Time: 23824.40 seconds (397.07 minutes | 6.62 hours)
2025-07-18 20:47:40 - [MAIN] - INFO - Dataset Generation Complete: 2025-07-18 20:47:40
2025-07-18 20:47:40 - [MAIN] - INFO - Timeline Alignment Score: 37.5%
2025-07-18 20:47:40 - [MAIN] - INFO - ❌ Timeline Quality: POOR - Requires attention
2025-07-18 20:47:40 - [MAIN] - INFO - ============================================================
2025-07-18 20:47:40,738 - __main__ - INFO - Cleaning up resources...
2025-07-18 20:47:40,738 - __main__ - INFO - Terminating Ryu controller (PID: 41507)...
2025-07-18 20:47:40,742 - __main__ - INFO - Cleaning up Mininet environment...
2025-07-18 20:47:42,392 - __main__ - INFO - Cleanup complete.
