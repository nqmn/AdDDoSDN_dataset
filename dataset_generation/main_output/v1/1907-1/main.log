2025-07-18 23:24:37 - [MAIN] - INFO - Cleaning up any previous Mininet instances...
2025-07-18 23:24:39 - [MAIN] - INFO - Mininet cleanup complete.
2025-07-18 23:24:39,300 - __main__ - INFO - Verifying required tools...
2025-07-18 23:24:39,548 - __main__ - INFO - TShark version: Running as user "root" and group "root". This could be dangerous.
2025-07-18 23:24:39,548 - __main__ - INFO - All required tools are available.
2025-07-18 23:24:39 - [MAIN] - INFO - Using configuration file: /home/user/Desktop/dataset_generation/config.json
2025-07-18 23:24:39,549 - __main__ - INFO - Starting Ryu SDN controller...
2025-07-18 23:24:39,555 - __main__ - INFO - Ryu controller started with PID: 67569. See main_output/ryu.log for logs.
2025-07-18 23:24:39,555 - __main__ - INFO - Checking for controller on port 6653 (timeout: 30s)...
2025-07-18 23:24:40,573 - __main__ - INFO - Controller is up and listening.
2025-07-18 23:24:40 - [MAIN] - INFO - Testing /hello endpoint...
2025-07-18 23:24:40 - [MAIN] - INFO - Test /hello endpoint: PASSED
2025-07-18 23:24:40,581 - __main__ - INFO - Setting up Mininet topology...
2025-07-18 23:24:40,827 - __main__ - INFO - Mininet version: 
2025-07-18 23:24:40,836 - __main__ - INFO - Connecting to remote controller at 127.0.0.1:6653
2025-07-18 23:24:41,113 - __main__ - INFO - Mininet network started successfully.
2025-07-18 23:24:41,113 - __main__ - INFO - Running Mininet pingall test...
2025-07-18 23:24:46,201 - __main__ - INFO - Mininet pingall test completed successfully. Packet loss: 0.0%
2025-07-18 23:24:46,201 - __main__ - INFO - Starting traffic generation scenario...
2025-07-18 23:24:46,201 - __main__ - INFO - Phase 1: Initialization (5s)...
2025-07-18 23:24:51,208 - __main__ - INFO - Starting flow statistics collection for 23825 seconds...
2025-07-18 23:24:51,209 - __main__ - INFO - Flow statistics collection started in background.
2025-07-18 23:24:51,211 - __main__ - INFO - Phase 2: Normal Traffic (3600s)...
2025-07-18 23:24:51,211 - __main__ - INFO - Timeline updated: normal phase started at 1752852291.211313
2025-07-19 00:24:55,358 - __main__ - INFO - Stopping packet capture (PID: 67833)...
2025-07-19 00:24:55,435 - __main__ - INFO - Packet capture stopped.
2025-07-19 00:24:55,435 - __main__ - INFO - Phase 3.1: Enhanced Traditional DDoS Attacks...
2025-07-19 00:24:55,435 - __main__ - INFO - Timeline updated: syn_flood phase started at 1752855895.4353878
2025-07-19 00:30:00,048 - __main__ - INFO - Stopping packet capture (PID: 91241)...
2025-07-19 00:30:00,130 - __main__ - INFO - Packet capture stopped.
2025-07-19 00:30:00,130 - __main__ - INFO - Timeline updated: udp_flood phase started at 1752856200.130499
2025-07-19 00:35:07,770 - __main__ - INFO - Stopping packet capture (PID: 91267)...
2025-07-19 00:35:07,928 - __main__ - INFO - Packet capture stopped.
2025-07-19 00:35:07,928 - __main__ - INFO - Timeline updated: icmp_flood phase started at 1752856507.9283667
2025-07-19 00:40:12,481 - __main__ - INFO - Stopping packet capture (PID: 91283)...
2025-07-19 00:40:12,538 - __main__ - INFO - Packet capture stopped.
2025-07-19 00:40:12,539 - __main__ - INFO - Phase 3.2: Adversarial DDoS Attacks...
2025-07-19 00:40:12,539 - __main__ - INFO - Timeline updated: ad_syn phase started at 1752856812.5392
2025-07-19 02:40:25,609 - __main__ - INFO - Stopping packet capture (PID: 91881)...
2025-07-19 02:40:25,682 - __main__ - INFO - Packet capture stopped.
2025-07-19 02:40:25,682 - __main__ - INFO - Timeline updated: ad_udp phase started at 1752864025.6822426
2025-07-19 04:00:36,964 - __main__ - INFO - Stopping packet capture (PID: 92575)...
2025-07-19 04:00:37,038 - __main__ - INFO - Packet capture stopped.
2025-07-19 04:00:37,038 - __main__ - INFO - Timeline updated: ad_slow phase started at 1752868837.0384047
2025-07-19 04:00:43,198 - __main__ - INFO - Proceeding with adversarial slow attack (no HTTP server required)
2025-07-19 04:00:43,198 - __main__ - INFO - Attack traffic will be captured via h6_slow_read.pcap and ad_slow.pcap
2025-07-19 06:01:03,343 - __main__ - INFO - Stopping packet capture (PID: 92984)...
2025-07-19 06:01:03,417 - __main__ - INFO - Packet capture stopped.
2025-07-19 06:01:03,418 - __main__ - INFO - Stopping packet capture (PID: 92983)...
2025-07-19 06:01:03,493 - __main__ - INFO - Packet capture stopped.
2025-07-19 06:01:03,493 - __main__ - INFO - Analyzing main_output/h6_slow_read.pcap for TCP issues...
2025-07-19 06:01:03,494 - __main__ - INFO - TCP Analysis on h6 PCAP: RST Count = 0, Retransmission Count = 0
2025-07-19 06:01:03,496 - __main__ - WARNING - Inter-Packet Arrival Time analysis failed for h6 PCAP: Not enough packets
2025-07-19 06:01:03,496 - __main__ - INFO - No HTTP server cleanup required.
2025-07-19 06:01:03,496 - __main__ - INFO - Phase 4: Cooldown (5s)...
2025-07-19 06:01:03,496 - __main__ - INFO - Timeline updated: normal phase started at 1752876063.4962294
2025-07-19 06:01:08,502 - __main__ - INFO - Signaling flow collection thread to stop...
2025-07-19 06:01:08,503 - __main__ - INFO - Waiting for flow collection thread to finish...
2025-07-19 06:01:08,521 - __main__ - INFO - Flow collection received stop signal, ending gracefully.
2025-07-19 06:01:08,521 - __main__ - INFO - Flow timeline collection completed.
2025-07-19 06:01:18,505 - __main__ - INFO - Flow statistics saved to main_output/flow_features.csv
2025-07-19 06:01:19,085 - __main__ - INFO - Flow collection thread finished successfully
2025-07-19 06:01:19,086 - __main__ - INFO - ============================================================
2025-07-19 06:01:19,086 - __main__ - INFO - COMPREHENSIVE TIMING SUMMARY
2025-07-19 06:01:19,086 - __main__ - INFO - ============================================================
2025-07-19 06:01:19,086 - __main__ - INFO - Configuration File: /home/user/Desktop/dataset_generation/config.json
2025-07-19 06:01:19,086 - __main__ - INFO - 
2025-07-19 06:01:19,086 - __main__ - INFO - Total Scenario Runtime: 23792.88 seconds (396.55 minutes)
2025-07-19 06:01:19,086 - __main__ - INFO - 
2025-07-19 06:01:19,086 - __main__ - INFO - Phase-by-Phase Breakdown:
2025-07-19 06:01:19,086 - __main__ - INFO -   Normal Traffic: 3604.22s (configured: 3600s)
2025-07-19 06:01:19,086 - __main__ - INFO -   Enhanced Traditional Attacks:
2025-07-19 06:01:19,086 - __main__ - INFO -     Enhanced Syn Flood: 304.70s (configured: 300s)
2025-07-19 06:01:19,086 - __main__ - INFO -     Enhanced Udp Flood: 307.80s (configured: 300s)
2025-07-19 06:01:19,087 - __main__ - INFO -     Enhanced Icmp Flood: 304.61s (configured: 300s)
2025-07-19 06:01:19,087 - __main__ - INFO -   Adversarial Attacks:
2025-07-19 06:01:19,087 - __main__ - INFO -     TCP State Exhaustion: 7213.14s (configured: 7200s)
2025-07-19 06:01:19,087 - __main__ - INFO -     Application Layer: 4811.36s (configured: 4800s)
2025-07-19 06:01:19,087 - __main__ - INFO -     Slow Read: 7226.46s (configured: 7200s)
2025-07-19 06:01:19,087 - __main__ - INFO -   Initialization: 5.01s (configured: 5s)
2025-07-19 06:01:19,087 - __main__ - INFO -   Cooldown: 5.01s (configured: 5s)
2025-07-19 06:01:19,087 - __main__ - INFO - ============================================================
2025-07-19 06:01:19,087 - __main__ - INFO - Traffic generation scenario finished.
2025-07-19 06:01:19 - [MAIN] - INFO - PCAP generation complete.
2025-07-19 06:01:19 - [MAIN] - INFO - Processing 8 PCAP files using 4 CPU cores...
2025-07-19 06:01:19,088 - __main__ - INFO - Starting parallel PCAP processing with 4 workers...
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing normal.pcap (24116 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing syn_flood.pcap (5597 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing udp_flood.pcap (3352 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing icmp_flood.pcap (5516 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing ad_syn.pcap (1198 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing ad_udp.pcap (1977 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing ad_slow.pcap (2791 records)
2025-07-19 06:01:38,223 - __main__ - INFO - ✓ Completed processing h6_slow_read.pcap (0 records)
2025-07-19 06:01:38,259 - __main__ - INFO - Parallel PCAP processing completed. Processed 8 files successfully.
2025-07-19 06:01:38 - [MAIN] - INFO - Parallel PCAP processing completed in 19.17 seconds (0.32 minutes)
2025-07-19 06:01:38 - [MAIN] - INFO - Combined labeled CSV generated at: main_output/packet_features.csv
2025-07-19 06:01:38 - [MAIN] - INFO - Final combined CSV created successfully.
2025-07-19 06:01:38 - [MAIN] - INFO - 
--- Packet Feature Counts by Class ---
2025-07-19 06:01:38 - [MAIN] - INFO -   normal: 24116 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   syn_flood: 5597 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   icmp_flood: 5516 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   udp_flood: 3352 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   unknown: 2439 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   ad_udp: 1526 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   ad_slow: 1391 packets
2025-07-19 06:01:38 - [MAIN] - INFO -   ad_syn: 610 packets
2025-07-19 06:01:38 - [MAIN] - INFO - Flow-level dataset generated at: main_output/flow_features.csv
2025-07-19 06:01:39 - [MAIN] - INFO - 
--- Flow Feature Counts by Class ---
2025-07-19 06:01:39 - [MAIN] - INFO -   ad_slow: 204755 flows
2025-07-19 06:01:39 - [MAIN] - INFO -   ad_syn: 198462 flows
2025-07-19 06:01:39 - [MAIN] - INFO -   ad_udp: 133300 flows
2025-07-19 06:01:39 - [MAIN] - INFO -   normal: 111197 flows
2025-07-19 06:01:39 - [MAIN] - INFO -   udp_flood: 9455 flows
2025-07-19 06:01:39 - [MAIN] - INFO -   syn_flood: 9362 flows
2025-07-19 06:01:39 - [MAIN] - INFO -   icmp_flood: 9362 flows
2025-07-19 06:01:39 - [MAIN] - INFO - Generating dataset summary...
2025-07-19 06:01:40 - [MAIN] - INFO - Dataset generation summary displayed above
2025-07-19 06:01:40 - [MAIN] - INFO - Running timeline analysis...
2025-07-19 06:01:40 - [MAIN] - INFO - Starting timeline analysis...
2025-07-19 06:01:41 - [MAIN] - INFO - Timeline Analysis Results:
2025-07-19 06:01:41 - [MAIN] - INFO -   Total attack types: 8
2025-07-19 06:01:41 - [MAIN] - INFO -   Good alignment: 3
2025-07-19 06:01:41 - [MAIN] - INFO -   Overall score: 37.5%
2025-07-19 06:01:41 - [MAIN] - INFO -   Status: ❌ POOR: Timeline alignment has major issues that need fixing.
2025-07-19 06:01:41 - [MAIN] - WARNING - Missing in flow data: unknown
2025-07-19 06:01:41 - [MAIN] - WARNING - Poor alignment: ad_slow, ad_syn, ad_udp, normal
2025-07-19 06:01:41 - [MAIN] - INFO - 
================================================================================
2025-07-19 06:01:41 - [MAIN] - INFO - 📊 DETAILED TIMELINE ANALYSIS REPORT
2025-07-19 06:01:41 - [MAIN] - INFO - ================================================================================
2025-07-19 06:01:41 - [MAIN] - INFO - Attack Type     Packet Timeline           Flow Timeline             Overlap    Status              
2025-07-19 06:01:41 - [MAIN] - INFO - ----------------------------------------------------------------------------------------------------
2025-07-19 06:01:41 - [MAIN] - INFO - ad_slow         3592.0s (1391 entries)    7225.5s (204755 entries)  3592.0s    ⚠️  TIMING OFFSET   
2025-07-19 06:01:41 - [MAIN] - INFO - ad_syn          3599.2s (610 entries)     7212.8s (198462 entries)  3599.2s    ⚠️  TIMING OFFSET   
2025-07-19 06:01:41 - [MAIN] - INFO - ad_udp          3599.2s (1526 entries)    4810.5s (133300 entries)  3599.2s    ⚠️  TIMING OFFSET   
2025-07-19 06:01:41 - [MAIN] - INFO - icmp_flood      297.3s (5516 entries)     303.4s (9362 entries)     297.1s     ✅ EXCELLENT MATCH   
2025-07-19 06:01:41 - [MAIN] - INFO - normal          3599.3s (24116 entries)   23776.3s (111197 entries) 3599.3s    ⚠️  TIMING OFFSET   
2025-07-19 06:01:41 - [MAIN] - INFO - syn_flood       297.9s (5597 entries)     303.5s (9362 entries)     297.9s     ✅ EXCELLENT MATCH   
2025-07-19 06:01:41 - [MAIN] - INFO - udp_flood       299.5s (3352 entries)     306.4s (9455 entries)     299.5s     ✅ EXCELLENT MATCH   
2025-07-19 06:01:41 - [MAIN] - INFO - unknown         15642.2s (2439 entries)   MISSING                   NONE       ❌ MISSING IN FLOW   
2025-07-19 06:01:41 - [MAIN] - INFO - 
================================================================================
2025-07-19 06:01:41 - [MAIN] - INFO - 🕐 DETAILED TIMING INFORMATION
2025-07-19 06:01:41 - [MAIN] - INFO - ================================================================================
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 AD_SLOW:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 04:00:43.200 - 05:00:35.195 (3592.0s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   04:00:37.959 - 06:01:03.495 (7225.5s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±5.2s, End±3628.3s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 AD_SYN:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 00:40:18.691 - 01:40:17.922 (3599.2s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   00:40:12.712 - 02:40:25.490 (7212.8s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±6.0s, End±3607.6s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 AD_UDP:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 02:40:29.757 - 03:40:28.954 (3599.2s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   02:40:26.495 - 04:00:36.953 (4810.5s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±3.3s, End±1208.0s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 ICMP_FLOOD:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 00:35:14.585 - 00:40:11.909 (297.3s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   00:35:08.332 - 00:40:11.701 (303.4s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±6.3s, End±0.2s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 NORMAL:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 23:24:55.227 - 00:24:54.548 (3599.3s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   23:24:51.218 - 06:01:07.519 (23776.3s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±4.0s, End±20173.0s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 SYN_FLOOD:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 00:25:01.592 - 00:29:59.532 (297.9s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   00:24:56.428 - 00:29:59.911 (303.5s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±5.2s, End±0.4s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 UDP_FLOOD:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 00:30:07.715 - 00:35:07.192 (299.5s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   00:30:00.921 - 00:35:07.323 (306.4s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Gap:    Start±6.8s, End±0.1s
2025-07-19 06:01:41 - [MAIN] - INFO - 
📍 UNKNOWN:
2025-07-19 06:01:41 - [MAIN] - INFO -    Packet: 01:40:19.088 - 06:01:01.275 (15642.2s)
2025-07-19 06:01:41 - [MAIN] - INFO -    Flow:   MISSING
2025-07-19 06:01:41 - [MAIN] - INFO - ================================================================================
2025-07-19 06:01:41 - [MAIN] - INFO - ============================================================
2025-07-19 06:01:41 - [MAIN] - INFO - FINAL EXECUTION SUMMARY
2025-07-19 06:01:41 - [MAIN] - INFO - ============================================================
2025-07-19 06:01:41 - [MAIN] - INFO - Total Execution Time: 23823.86 seconds (397.06 minutes | 6.62 hours)
2025-07-19 06:01:41 - [MAIN] - INFO - Dataset Generation Complete: 2025-07-19 06:01:41
2025-07-19 06:01:41 - [MAIN] - INFO - Timeline Alignment Score: 37.5%
2025-07-19 06:01:41 - [MAIN] - INFO - ❌ Timeline Quality: POOR - Requires attention
2025-07-19 06:01:41 - [MAIN] - INFO - ============================================================
2025-07-19 06:01:41,798 - __main__ - INFO - Cleaning up resources...
2025-07-19 06:01:41,798 - __main__ - INFO - Terminating Ryu controller (PID: 67569)...
2025-07-19 06:01:41,801 - __main__ - INFO - Cleaning up Mininet environment...
2025-07-19 06:01:43,441 - __main__ - INFO - Cleanup complete.
